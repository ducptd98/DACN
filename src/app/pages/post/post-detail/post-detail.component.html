<app-page-top [isHomePage]="false" imgPageTop="assets/page-top-bg.png" [header]="'Bài đăng'"></app-page-top>
<div class="container">
    <app-loading *ngIf="loading"></app-loading>
    <div *ngIf="!loading" class="">
        <div class="row" style="display: block !important;">
            <h1>{{post?.title || 'This is a title'}}</h1>
            <ng-container [ngTemplateOutlet]="meta"></ng-container>
            <span class="">
                #{{post?.tag || 'tag'}}
            </span>
            <p class="text-medium" style="white-space: pre-line">
                {{post?.content || 'This is a content'}}
            </p>
            <a [href]="post?.link" class="text-medium" style="white-space: pre-line">
                {{post?.link || 'This is a link'}}
            </a>
            <hr>
        </div>

        
        <h3 *ngIf="!isLogin" class="text-secondary text-center">
            <a [routerLink]="['/login']">Đăng nhập</a> để xem bình luận
        </h3>
        <div *ngIf="isLogin" class="">
            <app-comment [post]="post" (commentSubmit)="refresh($event)" [user]="this.user"></app-comment>
            <div class="" *ngFor="let cmt of post.comments">
                <app-comment [user]="user" [post]="post" [isPost]="false" [contentValue]="cmt.content" [cmtId]="cmt.id" (commentRemove)="refresh($event)"></app-comment>
            </div>
        </div>
    </div>
</div>
<ng-template #meta>
    <div class="article-meta">
        <a href="/angular-forum/profile/answebdev">
            <!-- <img src="https://static.productionready.io/images/smiley-cyrus.jpg"> -->
            <img [src]="post?.user?.avatar_path.encoded">
        </a>
        <div class="info">
            <a class="author" href="/angular-forum/profile/answebdev">
                {{post?.user?.name}}
            </a>
            <span class="date">{{post?.created_at |date: 'short'}}</span>
        </div>
        <ng-container [ngTemplateOutlet]="favorite"></ng-container>
    </div>
</ng-template>
<ng-template #favorite>
    <div class="pull-xs-right">
        <button class="btn btn-sm btn-outline-success" (click)="handleLike()">
            <i class="fas fa-heart"></i>
            {{post?.like || 0}}
        </button>
    </div>
</ng-template>